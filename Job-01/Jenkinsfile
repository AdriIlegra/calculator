pipeline {
    agent any

    stages {
        stage('Instalação do JFrog CLI') {
            steps {
                script {
                    // Define a URL do arquivo de instalação do JFrog CLI
                    def jfrogCliUrl = 'https://jfrog-cli-installers.jfrog.io/jfrog-cli-linux-amd64/jfrog'

                    // Define o local onde o JFrog CLI será instalado
                    def jfrogCliPath = "${tool name: 'jfrog-cli', type: 'Tool Installation'}"

                    // Baixa e instala o JFrog CLI
                    sh "curl -fL ${jfrogCliUrl} -o ${jfrogCliPath} && chmod +x ${jfrogCliPath}"
                }
            }
        }

        stage('Upload de Artefatos') {
            steps {
                script {
                    // Defina as credenciais para autenticação com o JFrog Artifactory
                    def jfrogUser = 'admin'
                    def jfrogPassword = '123Mudar@'

                    // Execute o comando de upload com o JFrog CLI
                    sh "${tool name: 'jfrog-cli', type: 'Tool Installation'} rt config --url=https://localhost:8082/artifactory --user=${jfrogUser} --password=${jfrogPassword}"
                    sh "${tool name: 'jfrog-cli', type: 'Tool Installation'} rt upload --recursive --props=build.name=my-build-name --build-number=1 meu-arquivo.txt meu-repo/my-path/"
                }
            }
        }
    }
}
