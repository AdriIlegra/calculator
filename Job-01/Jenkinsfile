pipeline {
    agent any

    environment {
        ARTIFACTORY_SERVER_ID = credentials('artifactory_server_id')
    }
    stages {
        stage('test') {
            steps {
                    sh ("./gradlew test")
            }
        }
        stage('build') {
            steps {
                    sh ("./gradlew clean build")
                }
        }

        stage('publish-artifactory') {
            steps {
                    rtUpload (
                        serverId: env.ARTIFACTORY_SERVER_ID,
                        spec: '''{
                              "files": [
                                {

                                }
                              ]
                        }'''
                   )
            }
        }
    }

}